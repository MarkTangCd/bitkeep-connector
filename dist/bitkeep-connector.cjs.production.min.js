"use strict";var e=require("@web3-react/abstract-connector");function t(){return(t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function n(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,o(e,t)}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function u(e,t,n){return(u=i()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&o(i,n.prototype),i}).apply(null,arguments)}function c(e){var t="function"==typeof Map?new Map:void 0;return(c=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return u(e,arguments,r(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),o(n,e)})(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}function s(e){return e.hasOwnProperty("result")?e.result:e}require("tiny-warning"),"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var d=function(e){function t(){var t;return(t=e.call(this)||this).name=t.constructor.name,t.message="No Ethereum provider was found on window.bitkeep.",t}return n(t,e),t}(c(Error)),f=function(e){function t(){var t;return(t=e.call(this)||this).name=t.constructor.name,t.message="The user rejected the request.",t}return n(t,e),t}(c(Error));exports.BitKeepConnector=function(e){function r(t){var n;return(n=e.call(this,t)||this).handleNetworkChanged=n.handleNetworkChanged.bind(h(n)),n.handleChainChanged=n.handleChainChanged.bind(h(n)),n.handleAccountsChanged=n.handleAccountsChanged.bind(h(n)),n.handleClose=n.handleClose.bind(h(n)),n}n(r,e);var o=r.prototype;return o.handleChainChanged=function(e){var t;this.emitUpdate({chainId:e,provider:null==(t=window.bitkeep)?void 0:t.ethereum})},o.handleAccountsChanged=function(e){0===e.length?this.emitDeactivate():this.emitUpdate({account:e[0]})},o.handleClose=function(e,t){this.emitDeactivate()},o.handleNetworkChanged=function(e){var t;this.emitUpdate({chainId:e,provider:null==(t=window.bitkeep)?void 0:t.ethereum})},o.activate=function(){try{var e,n=function(n){if(r)return n;function o(){return t({provider:window.bitkeep.ethereum},e?{account:e}:{})}var i=function(){if(!e)return Promise.resolve(window.bitkeep.ethereum.enable().then((function(e){return e&&s(e)[0]}))).then((function(t){e=t}))}();return i&&i.then?i.then(o):o()},r=!1;if(!window.bitkeep)throw new d;window.bitkeep.ethereum.on&&(window.bitkeep.ethereum.on("chainChanged",this.handleChainChanged),window.bitkeep.ethereum.on("accountsChanged",this.handleAccountsChanged),window.bitkeep.ethereum.on("close",this.handleClose),window.bitkeep.ethereum.on("networkChanged",this.handleNetworkChanged));var o=a((function(){return Promise.resolve(window.bitkeep.ethereum.send("eth_requestAccounts").then((function(e){return s(e)[0]}))).then((function(t){e=t}))}),(function(e){if(4001===e.code)throw new f}));return Promise.resolve(o&&o.then?o.then(n):n(o))}catch(e){return Promise.reject(e)}},o.getProvider=function(){try{var e;return Promise.resolve(null==(e=window.bitkeep)?void 0:e.ethereum)}catch(e){return Promise.reject(e)}},o.getChainId=function(){try{var e,t=function(){function t(){if(!e)try{e=s(window.bitkeep.ethereum.send({method:"net_version"}))}catch(e){}return e||(e=window.bitkeep.ethereum.isDapper?s(window.bitkeep.ethereum.cachedResults.net_version):window.bitkeep.ethereum.chainId||window.bitkeep.ethereum.netVersion||window.bitkeep.ethereum.networkVersion||window.bitkeep.ethereum._chainId),e}var n=function(){if(!e){var t=a((function(){return Promise.resolve(window.bitkeep.ethereum.send("net_version").then(s)).then((function(t){e=t}))}),(function(){}));if(t&&t.then)return t.then((function(){}))}}();return n&&n.then?n.then(t):t()};if(!window.bitkeep)throw new d;var n=a((function(){return Promise.resolve(window.bitkeep.ethereum.send("eth_chainId").then(s)).then((function(t){e=t}))}),(function(){}));return Promise.resolve(n&&n.then?n.then(t):t())}catch(e){return Promise.reject(e)}},o.getAccount=function(){try{var e,t=function(){function t(){return e||(e=s(window.bitkeep.ethereum.send({method:"eth_accounts"}))[0]),e}var n=function(){if(!e){var t=a((function(){return Promise.resolve(window.bitkeep.ethereum.enable().then((function(e){return s(e)[0]}))).then((function(t){e=t}))}),(function(){}));if(t&&t.then)return t.then((function(){}))}}();return n&&n.then?n.then(t):t()};if(!window.bitkeep)throw new d;var n=a((function(){return Promise.resolve(window.bitkeep.ethereum.send("eth_accounts").then((function(e){return s(e)[0]}))).then((function(t){e=t}))}),(function(){}));return Promise.resolve(n&&n.then?n.then(t):t())}catch(e){return Promise.reject(e)}},o.deactivate=function(){window.bitkeep&&window.bitkeep.ethereum.removeListener&&(window.bitkeep.ethereum.removeListener("chainChanged",this.handleChainChanged),window.bitkeep.ethereum.removeListener("accountsChanged",this.handleAccountsChanged),window.bitkeep.ethereum.removeListener("close",this.handleClose),window.bitkeep.ethereum.removeListener("networkChanged",this.handleNetworkChanged))},o.isAuthorized=function(){try{return window.bitkeep?Promise.resolve(a((function(){return Promise.resolve(window.bitkeep.ethereum.send("eth_accounts").then((function(e){return s(e).length>0})))}),(function(){return!1}))):Promise.resolve(!1)}catch(e){return Promise.reject(e)}},r}(e.AbstractConnector),exports.NoEthereumProviderError=d,exports.UserRejectedRequestError=f;
//# sourceMappingURL=bitkeep-connector.cjs.production.min.js.map
